<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="true"><meta name="msvalidate.01" content="true"><meta name="baidu-site-verification" content="true"><link rel="alternate" type="application/rss+xml" title="forget-me-not" href="https://maikire.xyz/rss.xml"><link rel="alternate" type="application/atom+xml" title="forget-me-not" href="https://maikire.xyz/atom.xml"><link rel="alternate" type="application/json" title="forget-me-not" href="https://maikire.xyz/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Unity,UnityShader"><link rel="canonical" href="https://maikire.xyz/2023/12/01/Unity/UnityShader/UnityShaderBasics/%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF/"><title>渲染管线 - UnityShaderBasics - UnityShader - Unity | Starry Letter = forget-me-not</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">渲染管线</h1><div class="meta"><span class="item" title="创建时间：2023-12-01 13:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-12-01T13:00:00+08:00">2023-12-01</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>6.4k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>6 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Starry Letter</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://img.z4a.net/images/2025/07/31/cg20.jpeg"></li><li class="item" data-background-image="https://img.z4a.net/images/2025/08/01/1597328139997.jpeg"></li><li class="item" data-background-image="https://img.z4a.net/images/2025/08/01/2023-02-20-161302.jpeg"></li><li class="item" data-background-image="https://img.z4a.net/images/2025/08/01/100879197.jpeg"></li><li class="item" data-background-image="https://img.z4a.net/images/2025/08/01/2023-02-20-161218.jpeg"></li><li class="item" data-background-image="https://img.z4a.net/images/2025/08/01/rsdf4.jpeg"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Unity/" itemprop="item" rel="index" title="分类于 Unity"><span itemprop="name">Unity</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Unity/UnityShader/" itemprop="item" rel="index" title="分类于 UnityShader"><span itemprop="name">UnityShader</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Unity/UnityShader/UnityShaderBasics/" itemprop="item" rel="index" title="分类于 UnityShaderBasics"><span itemprop="name">UnityShaderBasics</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://maikire.xyz/2023/12/01/Unity/UnityShader/UnityShaderBasics/%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Maikire"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="forget-me-not"></span><div class="body md" itemprop="articleBody"><h1 id="渲染管线"><a class="anchor" href="#渲染管线">#</a> 渲染管线</h1><p>渲染管线（Rendering Pipeline）是计算机图形学中用于将三维场景转化为二维图像的一系列处理步骤。它是一个由多个阶段组成的流水线，每个阶段都负责对图形数据进行特定的操作和处理。</p><h1 id="概念流水线"><a class="anchor" href="#概念流水线">#</a> 概念流水线</h1><p>从概念上可以分为 3 个阶段：应用阶段、几何阶段、光栅化阶段</p><ul><li>应用阶段<br>在 CPU 中进行。开发者拥有这个阶段的绝对控制权。这一阶段主要有三个任务：场景（模型、相机、特效等）、设置渲染状态（shader、材质贴图、纹理）、遮挡剔除。这一阶段的输出结果是渲染所需的几何信息，即渲染图元。</li><li>几何阶段<br>通常在 GPU 中进行。用于处理所有与我们要绘制的几何相关的东西。这一阶段的输出结果是屏幕空间的二维顶点坐标，每个顶点对应的深度值、着色器等信息。</li><li>光栅化阶段<br>在 GPU 中进行。使用上一个阶段传递的数据来生成屏幕上的像素，并渲染出最终的图像。它需要对上一个阶段得到的逐顶点数据（例如：纹理坐标、顶点颜色等）进行差值，然后在进行逐图像处理。</li></ul><p><img data-src="Pipeline_1.png" alt="img"></p><div class="note warning"><p>这里的流水线均是概念流水线，是我们为了给一个渲染流程进行基本的功能划分而提出来的。下面要介绍的 GPU 流水线，则是硬件真正用于实现上述概念的流水线。</p></div><h1 id="cpu和gpu之间的通信"><a class="anchor" href="#cpu和gpu之间的通信">#</a> CPU 和 GPU 之间的通信</h1><p>渲染流水线的起点是 CPU, 即应用阶段。应用阶段大致可分为 3 个阶段：把数据加载到显存中、设置渲染状态、调用 DrawCall</p><ul><li>把数据加载到显存中<br>所有的数据都需要从硬盘加载到内存中，然后，将网格和纹理等数据加载到显存中。数据加载到显存后，内存中的部分数据就可以移除了，对于另外一部分数据，CPU 还需要访问它们（例如：获取网格数据实现碰撞检测、基于网格的自动寻路等）。</li><li>设置渲染状态<br>渲染状态定义了场景中的网格是怎样被渲染的。例如：使用哪个顶点着色器 (Vertex Shader) / 片元着色器 (Fragment Shader)、光源属性、材质等。如果我们没有更改渲染状态，那么所有的网格都将使用同一种渲染状态。装备好上述所有数据后，CPU 需要调用一个命令通知 GPU 进行渲染，这个渲染命令称之为 DrawCall</li><li>调用 DrawCall<br>相信接触过渲染优化的读者应该都听说过 Draw Call。实际上，DrawCall 就是一个命令，它的发起方是 CPU，接收方是 GPU。这个命令仅仅会指向一个需要被渲染的图元列表，而不会再包含任何材质信息，这是因为我们已经在上一个阶段中完成了。<br>当给定了一个 DrawCall 时，GPU 就会根据渲染状态（例如材质、纹理、着色器等）和所有输入的顶点数据来进行计算，最终输出成屏幕上显示的那些漂亮的像素。而这个计算过程，就是我们接下来要讲的 GPU 流水线。</li></ul><h1 id="gpu流水线"><a class="anchor" href="#gpu流水线">#</a> GPU 流水线</h1><p>当 GPU 从 CPU 那里得到渲染命令后，就会进行一系列流水线操作，最终把图元渲染到屏幕上。</p><p>GPU 渲染流水线如下图所示，颜色表示不同阶段的可配置性或可编程性：</p><ul><li>绿色：流水线阶段是完全可编程控制的</li><li>橙色：流水线阶段可以配置但是不可编程</li><li>蓝色：流水线阶段是由 GPU 固定实现的（开发者没有控制权）</li><li>除可选择的阶段以外，其他阶段必须实现</li><li>部分名称在 OpenGL 和 DirectX 中不相同，本篇以 OpenGL 为例</li></ul><p><img data-src="Pipeline_2.png" alt="img"></p><ul><li>顶点数据：这些数据是由应用阶段加载到显存中，再由 DrawCall 指定的。<br><span class="label info">几何阶段</span></li><li>顶点着色器 (Vertex Shader)：完全可编程，通常用于实现顶点的空间变换、顶点着色等功能。</li><li>曲面细分着色器 (Tessellation Shader)：是一个可选的着色器，它用于细分图元。</li><li>几何着色器 (Geometry Shader)：同样是一个可选的着色器，它可以被用于执行逐图元 (Per-Primitive) 的着色操作，或者被用于产生更多的图元。</li><li>裁剪 (Clipping)：这一阶段的目的是将那些不在摄像机视野内的顶点裁剪掉，并剔除某些三角图元的面片。这个阶段是可配置的。例如，我们可以使用自定义的裁剪平面来配置裁剪区域，也可以通过指令控制裁剪三角图元的正面还是背面。</li><li>屏幕映射 (Screen Mapping)：这一阶段是不可配置和编程的，它负责把每个图元的坐标转换到屏幕坐标系中。<br><span class="label info">光栅化阶段</span></li><li>三角形设置 (Triangle Setup)：固定函数 (Fixed-Function) 的阶段。</li><li>三角形遍历 (Triangle Traversal)：固定函数 (Fixed-Function) 的阶段。</li><li>片元着色器 (Fragment Shader)：完全可编程，它用于实现逐片元 (Per-Fragment) 的着色操作。</li><li>逐片元操作 (Per-FragmentOperations)：负责执行很多重要的操作，例如修改颜色、深度缓冲、进行混合等，它不是可编程的，但具有很高的可配置性。</li></ul><p>接下来将对主要的流水线进行更详细的解释。</p><h2 id="顶点着色器"><a class="anchor" href="#顶点着色器">#</a> 顶点着色器</h2><p>顶点着色器 (Vertex Shader) 是流水线的第一个阶段，它的输入来自于 CPU。顶点着色器的处理单位是顶点，输入进来的每个顶点都会调用一次顶点着色器。顶点着色器本身不可以创建或者销毁任何顶点，而且无法得到顶点与顶点之间的关系。例如，我们无法得知两个顶点是否属于同一个三角网格。但正是因为这样的相互独立性，GPU 可以利用本身的特性并行化处理每一个顶点，这意味着这一阶段的处理速度会很快。<br>顶点着色器需要完成的工作主要有：坐标变换和逐顶点光照。除此以外，还包括后续阶段所需的其他数据（例如：顶点的颜色）。</p><p>坐标变换：把顶点坐标从模型空间转换到齐次裁剪空间。顶点着色器可以在这一步中改变顶点的位置，这在顶点动画中是非常有用的。例如，我们可以通过改变顶点位置来模拟水面、布料等。这个坐标在输出后会在硬件中做进一步处理（在硬件中做透视除法，最终得到归一化的设备坐标）。</p><p>OpenGL 和 Unity 使用相同的归一化的设备坐标 (Normalized Device Coordinates, NDC)，NDC 是以一个立方体为基础的，它的 z 分量范围在 [-1, 1] 之间，而在 DirectX 中，NDC 的 z 分量范围是 [0, 1]。顶点着色器可以有不同的输出方式。最常见的输出路径是经光栅化后交给片元着色器进行处理。而在现代的 Shader Model 中，它还可以把数据发送给曲面细分着色器或几何着色器。</p><h2 id="裁剪"><a class="anchor" href="#裁剪">#</a> 裁剪</h2><p>裁剪 (Clipping) 是为将那些不在摄像机视野内的顶点裁剪掉。<br>一个图元和摄像机视野的关系有 3 种：完全在视野内、部分在视野内、完全在视野外。</p><ul><li>完全在视野内的图元就继续传递给下一个流水线阶段（在视野范围内但被遮挡的物体也会传递）</li><li>完全在视野外的图元不会继续向下传递，因为它们不需要被渲染。</li><li>部分在视野内的图元需要进行处理，这就是裁剪。例如，一条线段的一个顶点在视野内，而另一个顶点不在视野内，那么在视野外部的顶点应该使用一个新的顶点来代替，这个新的顶点位于这条线段和视野边界的交点处。</li></ul><div class="note info"><p>在这一阶段中，Unity 引擎会执行遮挡剔除技术，以确定哪些物体被其他物体遮挡，从而决定在渲染过程中是否需要对它们进行渲染。</p></div><h2 id="屏幕映射"><a class="anchor" href="#屏幕映射">#</a> 屏幕映射</h2><p>屏幕映射 (Sereen Mapping) 的任务是把每个图元的 x 和 y 坐标转换到屏幕坐标系 (Sereen Coordinates) 下。屏幕映射得到的屏幕坐标决定了这个顶点对应屏幕上哪个像素以及距离这个像素有多远。这一步输入的坐标仍然是三维坐标系下的坐标 (范围在单位立方体内)。屏幕坐标系是个二维坐标系，它和我们用于显示画面的分辨率有很大关系。<br>屏幕映射的过程实际是一个缩放的过程。屏幕坐标系和 z 坐标一起构成了一个坐标系，叫做窗口坐标系 (Window Coordinates)。这些值都会传递到光栅化阶段。<br>屏幕坐标系在 OpenGL 和 DirectX 之间的差异问题：OpenGL 把屏幕的左下角当成最小的窗口坐标值（右上角为最大值），而 DirectX 则定义了屏幕的左上角为最小的窗口坐标值（右下角为最大值）。</p><h2 id="三角形设置"><a class="anchor" href="#三角形设置">#</a> 三角形设置</h2><p>从上一个阶段输出的信息是屏幕坐标系下的顶点位置以及和它们相关的额外信息，如深度值 (z 坐标)、法线方向、视角方向等。光栅化阶段有两个最重要的目标：计算每个图元覆盖了哪些像素，以及为这些像素计算它们的颜色。<br>光栅化的第一个流水线阶段是三角形设置 (Triangle Setup)。这个阶段会计算光栅化一个三角网格所需的信息。具体来说，上一个阶段输出的都是三角网格的顶点，即我们得到的是三角网格每条边的两个端点。但如果要得到整个三角网格对像素的覆盖情况，我们就必须计算每条边上的像素坐标。为了能够计算边界像素的坐标信息，我们就需要得到三角形边界的表示方式。这样一个计算三角网格表示数据的过程就叫做三角形设置。它的输出是为了给下一个阶段做准备。</p><h2 id="三角形遍历"><a class="anchor" href="#三角形遍历">#</a> 三角形遍历</h2><p>三角形遍历 (Triangle Traversal) 阶段将会检查每个像素是否被一个三角网格所覆盖。如果被覆盖的话，就会生成一个片元 (fragment)。而这样一个找到哪些像素被三角网格覆盖的过程就是三角形遍历，这个阶段也被称为扫描变换 (Scan Conversion)。<br>三角形遍历阶段会根据上一个阶段的计算结果来判断一个三角网格覆盖了哪些像素，并使用三角网格 3 个顶点的顶点信息对整个覆盖区域的像素进行插值。对应像素会生成一个片元。<br>这一步的输出就是得到一个片元序列。一个片元并不是真正意义上的像素，而是包含了很多状态的集合，这些状态用于计算每个像素的最终颜色。这些状态包括了 (但不限于) 它的屏幕坐标、深度信息，以及其他从几何阶段输出的顶点信息，例如：法线、纹理坐标等。</p><h2 id="片元着色器"><a class="anchor" href="#片元着色器">#</a> 片元着色器</h2><p>片元着色器 (Fragment Shader) 是另一个非常重要的可编程着色器阶段。在 DirectX 中，片元着色器被称为像素着色器 (Pixel Shader)，但片元着色器是一个更合适的名字，因为此时的片元并不是一个真正意义上的像素。<br>这一阶段可以完成很多重要的渲染技术，其中最重要的技术之一就是纹理采样。为了在片元着色器中进行纹理采样，我们通常会在顶点着色器阶段输出每个顶点对应的纹理坐标，然后经过光栅化阶段对三角网格的 3 个顶点对应的纹理坐标进行插值后，就可以得到其覆盖的片元的纹理坐标。<br>一般情况下，片元着色器仅能影响单个片元，不能将任何结果发送给它的邻居们。有一个例外情况：片元着色器可以访问到导数信息。</p><h2 id="逐片元操作"><a class="anchor" href="#逐片元操作">#</a> 逐片元操作</h2><p>逐片元操作 (Pe-Fragment Operations) 是 OpenGL 中的说法，在 DirecX 中，这一阶段被称为输出合并阶段 (Output-Merger)。Merger 这个词可能更容易让读者明白这一步骤的目的：合并。而 OpenGL 中的名字可以让读者明白这个阶段的操作单位，即是对每一个片元进行一些操作。逐片元操作阶段是高度可配置性的，我们可以设置每一步的操作细节。<br>这一阶段的主要任务：决定每个片元的可见性，这涉及了很多测试工作（例如深度测试、模板测试等）。如果一个片元通过了所有的测试，就需要把这个片元的颜色值和已经存储在颜色缓冲区中的颜色进行合并，或者说是混合。如果一个片元没有通过测试，那么它就会被舍弃，这就导致之前那么多的工作都白费了。</p><p>Unity 给出的渲染流水线中，它的深度测试是在片元着色器之前的（Early-Z 技术）这样就可以提前知道那些片元是被舍弃的，从而减少性能浪费（提前进行测试的检验结果可能与片元着色器中的一些操作冲突）。</p><p>测试的过程非常复杂，而且不同的图形学接口的实现细节也不尽相同。</p><p>当模型的图元经过了上面层层计算和测试后，就会显示到我们的屏幕上。我们的屏幕显示的就是颜色缓冲区中的颜色值。但是，为了避免我们看到那些正在进行光栅化的图元，GPU 会使用双重缓冲 (Double Buffering) 的策略。这意味着，对场景的渲染是在幕后发生的，即在后置缓冲 (Back Buffer) 中。一旦场景已经被渲染到了后置缓冲中，GPU 就会交换后置缓冲区和前置缓冲 (Front Buffer) 中的内容，而前置缓冲区是之前显示在屏幕上的图像。由此，保证了我们看到的图像总是连续的。</p><h1 id="一些常见的概念"><a class="anchor" href="#一些常见的概念">#</a> 一些常见的概念</h1><h2 id="opengl和directx"><a class="anchor" href="#opengl和directx">#</a> OpenGL 和 DirectX</h2><p>是图像应用编程接口。应用程序向接口发送渲染命令，这些接口会依次向显卡驱动发送渲染命令，显卡驱动将命令翻译成 GPU 能看懂的语言，同时也负责吧纹理等数据转换成 GPU 所支持的格式。</p><h2 id="hlsl-glsl-cg-il"><a class="anchor" href="#hlsl-glsl-cg-il">#</a> HLSL、GLSL、CG、IL</h2><ul><li>HLSL(High Level Shading Language)<br>微软的 DirectX 的专用语言。微软提供着色器的编译，不同平台的编译结果一致，但是 HLSL 仅能在微软自己的产品中使用。</li><li>GLSL(OpenGL Shading Language)<br>跨平台语言，可以在很多平台上运行。但是这种跨平台性是由于 OpenGL 没有提供着色器编译器，而是由显卡驱动来完成着色器的编译工作。好处在于供应商可以发挥出显卡的最大作用，但这也意味着 GLSL 的编译结果将取决于供应商，这可能会导致编译结果不一致。</li><li>CG(C for Graphic)<br>NVIDIA 提供的语言，真正的跨平台语言。它会根据不同的平台编译成相应的中间语言。CG 语言的跨平台性很大原因取决于与微软的合作，这也导致 CG 语言的语法和 HLSL 很像，CG 可以无缝移植 HLSL 代码。缺点是可能无法完全发挥出 OpenGL 的特性。</li><li>IL(Intermediate Language)<br>汇编语言，也称为中间语言</li></ul><p>在 Unity Shader 中可以使用这三种语言，但是尽管语法几乎一样，这些语言并非完全对应。例如：有些 CG 语法在 Unity Shader 中是不支持的。</p><h2 id="draw-call"><a class="anchor" href="#draw-call">#</a> Draw Call</h2><p>Draw Call 就是 CPU 调用图像编程接口，例如：OpenGL 中的 glDrawElements 或者 DirectX 中的 DrawIndexedPrimitive 命令，以命令 GPU 进行渲染的操作。</p><ul><li>性能问题的元凶<br>Draw Call 中造成性能问题的是 CPU</li><li>CPU 和 GPU 的并行工作<br>在 CPU 和 GPU 的并行工作中，有一个命令缓冲区，其中包含一个命令队列，命令缓冲区中的命令有很多种，Draw Call 是其中之一，还有改变渲染状态、改变着色器等。GPU 处理命令的速度要快于 CPU 发送命令的速度。</li><li>Draw Call 为什么会影响帧率<br>在每次调用 DrawCall 之前，CPU 需要向 GPU 发送很多内容，包括数据、状态和命令等。在这一阶段，CPU 需要完成很多工作，例如检查渲染状态等。而一旦 CPU 完成了这些准备工作，GPU 就可以开始本次的渲染。GPU 的渲染速度往往快于 CPU 提交命令的速度。如果 Draw Call 的数量太多，CPU 就会把大量时间花费在提交 Draw Call 上，造成 CPU 的过载。</li><li>减少 Draw Call<br>减少 Draw Call 的方法有很多，本篇仅讨论批处理技术。<br>批处理技术用于优化渲染性能，通过减少渲染调用的次数来提高游戏的运行效率。CPU 每次调用渲染前都需要准备大量的数据（除了物体本身的数据以外，还有很多额外的操作），多次重复这一过程会带来很大的性能消耗，所以，将一些物体合并到一起处理，然后再调用渲染，这样就会提高效率。</li></ul><h2 id="固定管线渲染"><a class="anchor" href="#固定管线渲染">#</a> 固定管线渲染</h2><p>固定函数的流水线，这是仅在一些很旧的 GPU 上才有渲染流水线，这种流水线仅可进行一些配置，不可编程，现代 GPU 已经完全舍弃了这种流水线。</p><h1 id="什么是-shader"><a class="anchor" href="#什么是-shader">#</a> 什么是 Shader</h1><p>Shader 所在的阶段就是渲染流水线的一部分，Shader 就是:</p><ul><li>GPU 流水线上些可高度编程的阶段，而由着色器编译出来的最终代码是会在 GPU 上运行的（对于固定管线的渲染来说，着色器有时等同于一些特定的渲染设置）</li><li>有一些特定类型的着色器，如顶点着色器、片元着色器等</li><li>依靠着色器我们可以控制流水线中的渲染细节，例如用顶点着色器来进行顶点变换以及传递数据，用片元着色器来进行逐像素的渲染。</li></ul><p>要得到出色的游戏画面是需要包括 Shader 在内的所有渲染流水线阶段的共同参与才可完成：设置适当的渲染状态，使用合适的混合函数，开启还是关闭深度测试 / 深度写入等。</p><p>Unity 为我们提供了一个既可以编写着色器，又可以设置渲染状态的地方: Unity Shader</p><div class="tags"><a href="/tags/Unity/" rel="tag"><i class="ic i-tag"></i> Unity</a> <a href="/tags/UnityShader/" rel="tag"><i class="ic i-tag"></i> UnityShader</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-06-15 17:52:03" itemprop="dateModified" datetime="2025-06-15T17:52:03+08:00">2025-06-15</time> </span><span id="2023/12/01/Unity/UnityShader/UnityShaderBasics/渲染管线/" class="item leancloud_visitors" data-flag-title="渲染管线" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Maikire 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Maikire 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Maikire 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Maikire <i class="ic i-at"><em>@</em></i>forget-me-not</li><li class="link"><strong>本文链接：</strong> <a href="https://maikire.xyz/2023/12/01/Unity/UnityShader/UnityShaderBasics/%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF/" title="渲染管线">https://maikire.xyz/2023/12/01/Unity/UnityShader/UnityShaderBasics/渲染管线/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/08/21/Unity/UnityToolClass/%E5%8A%A0%E8%BD%BD%E5%9C%BA%E6%99%AF%E7%AE%A1%E7%90%86%E5%99%A8/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;img.z4a.net&#x2F;images&#x2F;2025&#x2F;08&#x2F;01&#x2F;2023-02-20-161302.jpeg" title="加载场景管理器"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> UnityToolClass</span><h3>加载场景管理器</h3></a></div><div class="item right"><a href="/2024/01/13/Unity/UnityToolClass/AssetBundle%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%8A%A0%E8%BD%BD%E5%B7%A5%E5%85%B7/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;img.z4a.net&#x2F;images&#x2F;2025&#x2F;08&#x2F;01&#x2F;2022-09-01-164402.jpeg" title="AssetBundle创建与加载工具"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> UnityToolClass</span><h3>AssetBundle创建与加载工具</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF"><span class="toc-number">1.</span> <span class="toc-text">渲染管线</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-number">2.</span> <span class="toc-text">概念流水线</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cpu%E5%92%8Cgpu%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="toc-number">3.</span> <span class="toc-text">CPU 和 GPU 之间的通信</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gpu%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-number">4.</span> <span class="toc-text">GPU 流水线</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B6%E7%82%B9%E7%9D%80%E8%89%B2%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">顶点着色器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%81%E5%89%AA"><span class="toc-number">4.2.</span> <span class="toc-text">裁剪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%8F%E5%B9%95%E6%98%A0%E5%B0%84"><span class="toc-number">4.3.</span> <span class="toc-text">屏幕映射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E8%A7%92%E5%BD%A2%E8%AE%BE%E7%BD%AE"><span class="toc-number">4.4.</span> <span class="toc-text">三角形设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E8%A7%92%E5%BD%A2%E9%81%8D%E5%8E%86"><span class="toc-number">4.5.</span> <span class="toc-text">三角形遍历</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%87%E5%85%83%E7%9D%80%E8%89%B2%E5%99%A8"><span class="toc-number">4.6.</span> <span class="toc-text">片元着色器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%90%E7%89%87%E5%85%83%E6%93%8D%E4%BD%9C"><span class="toc-number">4.7.</span> <span class="toc-text">逐片元操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">5.</span> <span class="toc-text">一些常见的概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#opengl%E5%92%8Cdirectx"><span class="toc-number">5.1.</span> <span class="toc-text">OpenGL 和 DirectX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hlsl-glsl-cg-il"><span class="toc-number">5.2.</span> <span class="toc-text">HLSL、GLSL、CG、IL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#draw-call"><span class="toc-number">5.3.</span> <span class="toc-text">Draw Call</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E7%AE%A1%E7%BA%BF%E6%B8%B2%E6%9F%93"><span class="toc-number">5.4.</span> <span class="toc-text">固定管线渲染</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-shader"><span class="toc-number">6.</span> <span class="toc-text">什么是 Shader</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2023/12/01/Unity/UnityShader/UnityShaderBasics/%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF/" rel="bookmark" title="渲染管线">渲染管线</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Maikire" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Maikire</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">74</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">19</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">14</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL21haWtpcmU=" title="https:&#x2F;&#x2F;github.com&#x2F;maikire"><i class="ic i-github"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTQyNTE2MzE4MA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;425163180"><i class="ic i-cloud-music"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMzgxNDY5ODQ5P3NwbV9pZF9mcm9tPTMzMy4xMDA3LjAuMA==" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;381469849?spm_id_from&#x3D;333.1007.0.0"><i class="ic i-bilibili"></i></span> <span class="exturl item email" data-url="bWFpbHRvOmwyNTQxNzU4OTg5QGdtYWlsLmNvbQ==" title="mailto:l2541758989@gmail.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/games" rel="section"><i class="ic i-play"></i>游戏</a></li><li class="item"><a href="/friends" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/08/21/Unity/UnityToolClass/%E5%8A%A0%E8%BD%BD%E5%9C%BA%E6%99%AF%E7%AE%A1%E7%90%86%E5%99%A8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/01/13/Unity/UnityToolClass/AssetBundle%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%8A%A0%E8%BD%BD%E5%B7%A5%E5%85%B7/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Lua/" title="分类于 Lua">Lua</a></div><span><a href="/2025/01/20/Lua/Lua/" title="Lua">Lua</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="分类于 CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CSharpBasics/" title="分类于 CSharpBasics">CSharpBasics</a></div><span><a href="/2023/03/28/CSharp/CSharpBasics/%E6%9E%9A%E4%B8%BE%E5%99%A8%EF%BC%88Enumerator%EF%BC%89/" title="枚举器（Enumerator）">枚举器（Enumerator）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DesignPatterns/" title="分类于 DesignPatterns">DesignPatterns</a></div><span><a href="/2023/07/21/DesignPatterns/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/" title="外观模式">外观模式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DesignPatterns/" title="分类于 DesignPatterns">DesignPatterns</a></div><span><a href="/2023/07/31/DesignPatterns/MVC%E6%A8%A1%E5%BC%8F/" title="MVC模式">MVC模式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="分类于 CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CSharpBasics/" title="分类于 CSharpBasics">CSharpBasics</a></div><span><a href="/2023/03/28/CSharp/CSharpBasics/%E4%BA%8B%E4%BB%B6%EF%BC%88Event%EF%BC%89/" title="事件（Event）">事件（Event）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Shoka/" title="分类于 Shoka">Shoka</a></div><span><a href="/2024/09/01/Shoka/Shoka%E4%B8%BB%E9%A2%98%E7%9A%84%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/" title="Shoka主题的数学公式">Shoka主题的数学公式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CSharp/" title="分类于 CSharp">CSharp</a> <i class="ic i-angle-right"></i> <a href="/categories/CSharp/CSharpBasics/" title="分类于 CSharpBasics">CSharpBasics</a></div><span><a href="/2023/03/25/CSharp/CSharpBasics/CSharp%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/" title="CSharp基础笔记">CSharp基础笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Unity/" title="分类于 Unity">Unity</a> <i class="ic i-angle-right"></i> <a href="/categories/Unity/UnityBasics/" title="分类于 UnityBasics">UnityBasics</a></div><span><a href="/2023/07/21/Unity/UnityBasics/Unity%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="Unity性能优化">Unity性能优化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Unity/" title="分类于 Unity">Unity</a> <i class="ic i-angle-right"></i> <a href="/categories/Unity/UnityGames/" title="分类于 UnityGames">UnityGames</a> <i class="ic i-angle-right"></i> <a href="/categories/Unity/UnityGames/Unity2DGames/" title="分类于 Unity2DGames">Unity2DGames</a></div><span><a href="/2023/06/13/Unity/UnityGames/Unity2DGames/%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E7%BD%91%E7%BB%9C%E8%81%8A%E5%A4%A9%E5%AE%A4/" title="制作一个简单的网络聊天室">制作一个简单的网络聊天室</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DesignPatterns/" title="分类于 DesignPatterns">DesignPatterns</a></div><span><a href="/2023/07/18/DesignPatterns/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" title="代理模式">代理模式</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Maikire @ Starry Letter</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/12/01/Unity/UnityShader/UnityShaderBasics/渲染管线/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="//fastly.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>